# Deep-learning-for-disability
Deep learning model for all-cause mortality among the older people with disability in China

Artificial neural network model based on R environment and evaluation of the model

# Selection of predictors
Overall, about 10% of the data were missing for the covariates, and multiple imputation methods were used for the correction of the missing data [20]. The overall covariates were divided into three groups, numeric covariates, binary covariates and factor covariates. We used predictive mean matching to impute numeric features, logistic regression to impute binary variables and Bayesian polytomous regression to impute factor features. 

# Deep learning model development
Least absolute shrinkage and selection operator (LASSO) was used to identify predictors with with statistically significant (P < 0.05) hazard ratios (HR) [23]. We divided the total participants into model training set (2017 cohort) and validation set (2019 cohort). The training set consisted of participants included since September 2017, and validation set was those included since September 2019. We used the R package "survival models" to build the artificial neural network (ANN) (https://CRAN.R-project.org/package=survivalmodels). To build a robust and efficient ANN model, the "mlr3" package was used to tune the parameters [24]. The model was trained in the training set, the input layer was selected clinical variables, and the activation function of the hidden layer was ReLU. Loss function was the negative log partial likelihood under the Cox proportional hazards model. To avoid overfitting, we used 5-fold nested cross-validation and dropout parameters after each hidden layer. Early stopping strategy =0.3 was also utilized for the regularization purpose. The hyper-parameters in our ANN model included: the depth and the size of the network, dropout rate, learning rate, and weight decay (Supplementary file 1, Figure S1). To tune these hyper-parameters, we performed a 1000 iteration random search using ‘adam’ optimizer and c-index optimization. The final optimized model parameters was presented in Supplementary file 2.
The concordance index (C-index) and area under curve (AUC) for the receiver-operator characteristic (ROC) were evaluated on the model validation cohort to assess predictive performance, with ranges from 0.5 (random chance) and 1.0 (perfect prediction) [25]. The time-dependent ROC curves were used to compare the predictive performance in every half-year follow-up.  
We further calculated the risk of each individual in the entire training cohort and divided all patients into three groups based on the risk cut-off at 95% sensitivity and 95% specificity. The total cohorts were classified in low-, medium-, and high-risk group, respectively. Finally, a predicted risk value for each long-term care patient is generated based on Cox regression and a risk estimation is provided.
Note： If you use the ANN pipline, please ensure that you have enough RAM (over 64gb)

# Subgroup analysis 
Subgroup analysis was performed to identify predictors of mortality in specific groups, and conducted by: 1) male versus female participants; 2) participants aged < 80 years versus aged ≥ 80 years; 3) participants with BMI <18.5kg/m2 versus BMI 18.5-24.5 kg/m2 and BMI >24.5kg/m2; 4) participants who live alone versus live with people; 5) participants with severe impaired physical ability versus those with mild and moderate impaired physical ability; 6) participants with severe and moderate impaired cognitive ability versus those with mild impaired and robust cognitive ability; 7) participants with severe and moderate impaired perceptual ability versus those with mild impaired and robust perceptual ability. P value for interaction was performed using Cox regression, and available confounding factors were adjusted.

# Statistical methods
Continuous variables were described as mean ± standard deviation and categorical variables were described as proportions. All statistical analyses were conducted with R software (version 4.1.0, Free Software Foundation, Inc., Boston, MA). The "survcomp" R package was used to calculate the consistency C-index, with a larger c-index indicating more accurate predictive power of the model. The ROC curve of the model was calculated and generated using the "pROC" package. The "timeROC" package was used to plot time-dependent ROC curves. Survival curves were drawn by the "survminer" package. Statistical significance was set at 0.05, with two-tailed statistical testing.

